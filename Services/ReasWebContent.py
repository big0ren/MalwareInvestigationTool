# -*- coding: utf-8 -*-
"""
Created on Sat May 21 15:09:15 2016

@author: root
"""

import json
import urllib
import time
import os

myTeam = u""
myTeam1 = u""
myTeam2 = u""

while True:
    for t in range(6, -1, -1):
        minutes = t / 60
        seconds = t % 60
        time.sleep(1.0)
        if minutes == 0 and seconds == 0:
            link = "http://www.telesport.co.il/ajaxactions/sportlivepage.ashx?c=c5058027&sportLive=updateGamesLive"
            Ttime = time.strftime("%H:%M:%S")
            ScoreList = urllib.urlopen(link)
            s = ScoreList.read()
            t = """print s """
            decoded = json.loads(s)
            # pretty printing of json-formatted string
            ObjCount = len(decoded) - 1
            os.system('CLS')
            print Ttime
            for i in range(0, ObjCount):
                if decoded[i]['branch_name'] in [u'כדורגל']:# and decoded[i]['leagueGroup_name'] in [u'ישראל ליגת העל']:
                    Teams = decoded[i]['twoPVSI']['p1_name'] + u" נגד " + decoded[i]['twoPVSI']['p2_name']
                    if myTeam.encode(encoding='UTF-8') in Teams.encode(encoding='UTF-8'):
                        # or myTeam1.encode(encoding='UTF-8') in Teams.encode(encoding='UTF-8') or myTeam2.encode(encoding='UTF-8') in Teams.encode(encoding='UTF-8'):
                        print "\n" + str(i) + ") " + Teams
                        print str(decoded[i]['twoPVSI']['p2score']) + ":" + str(
                            decoded[i]['twoPVSI']['p1score']) + " | " + u" דקה:" + decoded[i][
                                  'status_name_display'] + "\n"
                        ScoreGame = str(decoded[i]['twoPVSI']['p2score']) + ":" + str(decoded[i]['twoPVSI']['p1score'])
                        if ScoreGame not in ['0:0']:
                            event = len(decoded[i]['twoPVSI']['p1_events'])
                            for ev in range(0, event):
                                if decoded[i]['twoPVSI']['p1_events'][ev]['type'] == 1:
                                    Scorer = decoded[i]['twoPVSI']['p1_name'] + " - " + \
                                             decoded[i]['twoPVSI']['p1_events'][ev]['participant_name'] + " : "
                                    SMinute = str(decoded[i]['twoPVSI']['p1_events'][ev]['extraParam']) + "'"
                                    print Scorer + SMinute
                            event = len(decoded[i]['twoPVSI']['p2_events'])
                            for ev in range(0, event):
                                if decoded[i]['twoPVSI']['p2_events'][ev]['type'] == 1:
                                    Scorer = decoded[i]['twoPVSI']['p2_name'] + " - " + \
                                             decoded[i]['twoPVSI']['p2_events'][ev]['participant_name'] + " : "
                                    SMinute = str(decoded[i]['twoPVSI']['p2_events'][ev]['extraParam']) + "'"
                                    print Scorer + SMinute
