import urllib2
import time
import smtplib
import datetime
url = "https://www.sabrespro.co.il/artist_shows/12"
#url = "http://127.0.0.1"
response = urllib2.urlopen(url, timeout = 5)
content = response.read()
content = content[str(content).find("  <!-- CONTENT FOR TAB -->"):str(content).find(" <!-- END CONTENT FOR TAB -->")]
while True:
    try:
        response = urllib2.urlopen(url, timeout = 60)
        GetAnswer = str(response.read())
        if content != GetAnswer[str(GetAnswer).find("  <!-- CONTENT FOR TAB -->"):str(GetAnswer).find(" <!-- END CONTENT FOR TAB -->")]:
            print "The Site Has Changed"
            response = urllib2.urlopen(url, timeout=5)
            content = response.read()
            content = content[str(content).find("  <!-- CONTENT FOR TAB -->"):str(content).find(" <!-- END CONTENT FOR TAB -->")]

            msg = 'This is Oren script talking, Check Adir Miller Concert\nPlease visit the site below: https://www.sabrespro.co.il/artist_shows/12\n\nYou can buy tickets now :)'
            # set the 'from' address,
            fromaddr = 'dlptesting4soc@gmail.com '
            # set the 'to' addresses,
            toaddrs = 'orenmaoz@gmail.com'

            # setup the email server,
            server = smtplib.SMTP('smtp.gmail.com', 587)
            server.starttls()
            # add my account login name and password,
            server.login("dlptesting4soc", "BankIgudSocDepartment2o14")

            # Print the email's contents
            print('From: ' + fromaddr)
            print('To: ' + str(toaddrs))
            print('Message: ' + msg)

            # send the email
            server.sendmail(fromaddr, toaddrs, msg)
            # disconnect from the server
            server.quit()
            time.sleep(50)
        else:

            print str(datetime.datetime.now()) + ' | The site hasn\'t been Changed'
            time.sleep(500)

    except urllib2.URLError as e:
        print type(e)